df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
text = element_text(family = ft, colour = txt, size = 14),
plot.background = element_rect(fill = bg, colour = bg),
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(margin = margin(b = 30, t = 10), lineheight = 0.3),
plot.margin = margin(t = 50, b = 170, l = 50, r = 50),
plot.caption = element_markdown(size = 12, hjust = 0.5, margin = margin(t = 20)),
axis.title.x = element_text(),
axis.title.y = element_text(angle = 90),
axis.text = element_text(margin = margin(t = 10, b = 10, l = 10, r = 10)),
axis.ticks = element_line(colour = line),
axis.line = element_line(colour = line),
panel.grid = element_line(colour = line, linetype = 3)
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.background = element_rect(fill = bg, colour = bg),
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(margin = margin(b = 30, t = 10), lineheight = 0.3),
plot.margin = margin(t = 50, b = 170, l = 50, r = 50),
plot.caption = element_markdown(size = 12, hjust = 0.5, margin = margin(t = 20)),
axis.title.x = element_text(),
axis.title.y = element_text(angle = 90),
axis.text = element_text(margin = margin(t = 10, b = 10, l = 10, r = 10)),
axis.ticks = element_line(colour = line),
axis.line = element_line(colour = line),
panel.grid = element_line(colour = line, linetype = 3)
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(margin = margin(b = 30, t = 10), lineheight = 0.3),
plot.margin = margin(t = 50, b = 170, l = 50, r = 50),
plot.caption = element_markdown(size = 12, hjust = 0.5, margin = margin(t = 20)),
axis.title.x = element_text(),
axis.title.y = element_text(angle = 90),
axis.text = element_text(margin = margin(t = 10, b = 10, l = 10, r = 10)),
axis.ticks = element_line(colour = line),
axis.line = element_line(colour = line),
panel.grid = element_line(colour = line, linetype = 3)
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(margin = margin(b = 30, t = 10), lineheight = 0.3),
plot.margin = margin(t = 50, b = 170, l = 50, r = 50),
axis.title.x = element_text(),
axis.title.y = element_text(angle = 90),
axis.text = element_text(margin = margin(t = 10, b = 10, l = 10, r = 10)),
axis.ticks = element_line(colour = line),
axis.line = element_line(colour = line),
panel.grid = element_line(colour = line, linetype = 3)
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(margin = margin(b = 30, t = 10), lineheight = 0.3),
plot.margin = margin(t = 50, b = 170, l = 50, r = 50),
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 24, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 16, face = "italic" ,hjust = 0.5),
)
# Kaplan-Meier survival curves
# code is simplified and plot won't match below
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
# boxplots
survivalists |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender"
) +
coord_flip() +
theme_void() +
theme(
text = element_text(family = ft, colour = txt, size = 48),
plot.background = element_rect(fill = bg, colour = bg),
legend.position = "none"
)
# boxplots
survivalists |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender",
colour = "Gender",
title = "Survival boxplot",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
) +
coord_flip() +
theme_void() +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
?coord_flip
# boxplots
survivalists |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender",
colour = "Gender",
title = "Survival boxplot",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
) +
theme_void() +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
# boxplots
survivalists |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender",
x = "Gender",
y = "Days lasted",
title = "Survival boxplot",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
) +
theme_void() +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
# boxplots
survivalists |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender",
x = "Gender",
y = "Days lasted",
title = "Survival boxplot",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
?dplyr
?geom_jitter
?left_join
?cumsum
?count
?expand_grid
?unique
?replace_na
View(loadouts)
load_mean <- map(.x=loadouts$item_number, .f = ~mean(.x) )
View(load_mean)
?summarise
clean_load <- loadouts |>
group_by(name)
clean_load <- loadouts |>
group_by(name, season) |>
summarise(
load_minimum = min(item_number),
load_maximum = max(item_number),
load_mean = mean(item_number)
)
View(clean_load)
clean_load2 <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(
load_stats = map(.x = data, .f = ~tibble(
load_minimum = minimum(.x$item_number),
load_maximum = maximum(.x$item_number),
load_mean = mean(.x$item_number)
))
) %>%
select(-data) %>%
unnest(load_stats)
View(clean_load2)
?map_dfr
calculate_stats <- function(df) {
list(
load_minimum = minimum(df$item_number),
load_maximum = maximum(df$item_number),
load_mean = mean(df$item_number)
)
}
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(.x = data, .f = calculate_stats)) %>%
select(-data) %>%
map_dfr(bind_rows, .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(.x = data,  calculate_stats)) %>%
select(-data) %>%
map_dfr(bind_rows, .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(  data,  calculate_stats)) %>%
select(-data) %>%
map_dfr(bind_rows, .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(  data,  calculate_stats)) %>%
select(-data) %>%
map_dfr(bind_rows )
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(  data,  calculate_stats)) %>%
select(-data)
View(clean_load)
clean_load <- map_dfr( .x = clean_load, .f = bind_rows , .id = c("name", "season") )
?bind_rows
clean_load <- map_dfr( .x = clean_load, .f = bind_rows(.x) , .id = c("name", "season") )
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map(  data,  calculate_stats)) %>%
select(-data) %>%
map_dfr( bind_rows(.x), .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map( .x= data,  calculate_stats)) %>%
select(-data) %>%
map_dfr( bind_rows(.x), .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map( .x= data,  calculate_stats)) %>%
select(-data) %>%
map_dfr( ~bind_rows(.x), .id = c("name", "season"))
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map( .x= data,  calculate_stats)) %>%
select(-data)
clean_load <- map_dfr( .x = clean_load, .f = ~bind_rows(.x) , .id = c("name", "season") )
clean_load <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(stats = map( .x= data,  calculate_stats)) %>%
select(-data)
View(clean_load)
clean_load <- map_dfr(clean_load, ~bind_rows(.x$stats), .id = "group_id")
# clean_load <- loadouts |>
#       group_by(name, season) |>
#       summarise(
#             load_minimum = min(item_number),
#             load_maximum = max(item_number),
#             load_mean = mean(item_number)
#       )
clean_load2 <- loadouts %>%
group_by(name, season) %>%
nest() %>%
mutate(
load_stats = map(.x = data, .f = ~tibble(
load_minimum = minimum(.x$item_number),
load_maximum = maximum(.x$item_number),
load_mean = mean(.x$item_number)
))
) %>%
select(-data) %>%
unnest(load_stats)
View(loadouts)
View(survivalists)
clean_survival <- survivalists |>
detect(.x = data,  dir="United States"  )
# Convert the data frame to a list of rows
list_of_rows <- as_tibble_row(survivalists)
# Create a logical vector indicating rows where 'data' contains "United States"
has_united_states <- map_lgl(survivalists$data, ~ str_detect(.x, "United States"))
# Filter the data frame using this logical vector
clean_survival <- survivalists %>%
filter(has_united_states)
# Filter the data frame using this logical vector
clean_survival <- survivalists[has_united_states, ]
View(clean_survival)
# Create a logical vector indicating rows where 'data' contains "United States"
has_united_states <- map_lgl(survivalists$data, ~ str_detect(.x, "United States"))
# Filter the data frame using this logical vector
clean_survival <- survivalists[has_united_states, ]
View(clean_survival)
has_united_states
View(survivalists)
# Create a logical vector indicating rows where 'data' contains "United States"
has_united_states <- map_lgl(survivalists$country, ~ str_detect(.x, "United States"))
# Filter the data frame using this logical vector
clean_survival <- survivalists[has_united_states, ]
df <- expand_grid(
days_lasted = 0: maximum(clean_survival$days_lasted),
gender = unique(clean_survival$gender)
) |>
left_join(
clean_survival |>
count(days_lasted, gender),
by = c("days_lasted", "gender")
) |>
left_join(
clean_survival |>
count(gender, name = "N"),
by = "gender"
) |>
group_by(gender) |>
mutate(
n = replace_na(n, 0),
n_lasted = N-cumsum(n),
p = n_lasted/N
)
df |>
ggplot(aes(days_lasted, p, colour = gender)) +
geom_line() +
labs(
x = "Days lasted",
y = "Proportion remaining",
colour = "Gender",
title = "Survival curves",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
clean_survival |>
ggplot(aes(gender, days_lasted, color = gender, fill = gender)) +
geom_boxplot(alpha = 0.5) +
geom_jitter(width = 0.2, pch = 1, size = 3) +
theme_minimal() +
labs(
colour = "Gender",
fill = "Gender",
x = "Gender",
y = "Days lasted",
title = "Survival boxplot",
subtitle = "There is some evidence that, on average, women tend to survive longer than men",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
View(clean_load2)
View(clean_survival)
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_histogram()
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_histogram(stat_bin())
?geom_histogram
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_histogram(stat = "bin")
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_histogram(stat = "bin",   position = "stack")
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_line( )
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_line( ) +
facet_grid(~gender)
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_smooth( ) +
facet_grid(~gender)
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_smooth() +
facet_grid(~gender) +
theme_minimal() +
labs(
x = "Age",
y = "Days lasted",
title = "Survival time by age",
subtitle = "There is some evidence that, younger women tend to survive longer, older men tend to survival longer",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 11, face = "italic" ,hjust = 0.5),
)
clean_survival |>
ggplot( aes(age, days_lasted) ) +
geom_smooth() +
facet_grid(~gender) +
theme_minimal() +
labs(
x = "Age",
y = "Days lasted",
title = "Survival time by age",
subtitle = "There is some evidence that, younger women tend to survive longer, older men tend to survival longer",
caption = "Siyu Zou"
) +
theme(
plot.title = element_text(size = 16, face = "bold",hjust = 0.5),
plot.subtitle = element_text(size = 10, face = "italic" ,hjust = 0.5),
)
usethis::use_pkgdown()
pkgdown::build_site()
usethis::use_github()
usethis::use_pkgdown_github_pages()
usethis::use_github_action("pkgdown")
pkgdown::build_site()
